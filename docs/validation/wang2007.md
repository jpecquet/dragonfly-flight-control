# Wang and Russell 2007

This case study runs tethered simulations using wing kinematics derived from {cite}`wang2007`.
A high-fidelity Fourier representation using 7 harmonics per wingbeat
(35 Fourier components over 5 wingbeats) is compared to a single harmonic representation.

Pipeline stages: `sim -> post`

## Key Parameters

```{include} generated/wang2007_key_parameters.md
```

## Pre-processing

### Kinematics Data

The `s`, `d`, and `beta` traces below are the Fourier-smoothed inputs
used to build the high-fidelity (35-component) wing kinematics.

```{raw} html
<img
  class="case-study-image"
  src="../_static/media/wang2007/kinematics_inputs.dark.png"
  alt="Wang 2007 smoothed input kinematics for s, d, and beta"
  data-light-src="../_static/media/wang2007/kinematics_inputs.light.png"
  data-dark-src="../_static/media/wang2007/kinematics_inputs.dark.png"
/>
```

### Mapped Simulator Angles (`phi`, `psi`)

The simulator motion inputs are constructed from the smoothed traces using:

- `phi = arcsin(s / r)`
- `psi = pi/2 - beta`

```{raw} html
<img
  class="case-study-image"
  src="../_static/media/wang2007/motion_mapping.dark.png"
  alt="Wang 2007 mapped simulator angles phi and psi"
  data-light-src="../_static/media/wang2007/motion_mapping.light.png"
  data-dark-src="../_static/media/wang2007/motion_mapping.dark.png"
/>
```

## Results

### Wing Motion 3D Visualization

```{raw} html
<video
  class="case-study-video"
  controls
  loop
  autoplay
  muted
  preload="metadata"
  data-light-src="../_static/media/wang2007/simulation.light.mp4"
  data-dark-src="../_static/media/wang2007/simulation.dark.mp4"
>
  <source src="../_static/media/wang2007/simulation.dark.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
```

### Wing Motion Stick Plot

```{raw} html
<video
  class="case-study-video"
  controls
  loop
  autoplay
  muted
  preload="metadata"
  data-light-src="../_static/media/wang2007/stroke_fore_left.light.mp4"
  data-dark-src="../_static/media/wang2007/stroke_fore_left.dark.mp4"
>
  <source src="../_static/media/wang2007/stroke_fore_left.dark.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
```

### Force Comparison

The plot overlays simulation force traces with the external CFD reference from
`data/kinematics/wang2007/cfd_data.csv`.

```{raw} html
<img
  class="case-study-image"
  src="../_static/media/wang2007/force_comparison.dark.png"
  alt="Wang 2007 vertical force comparison plot"
  data-light-src="../_static/media/wang2007/force_comparison.light.png"
  data-dark-src="../_static/media/wang2007/force_comparison.dark.png"
/>
```

## Reproduction Commands

```bash
# Regenerate and sync all media
python scripts/update_docs_media.py
```

## References

```{bibliography}
:filter: docname in docnames
```
